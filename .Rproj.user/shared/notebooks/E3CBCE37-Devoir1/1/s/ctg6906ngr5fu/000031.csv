"0","# Création d'une colonne contenant les numéros de département en les triant dans l'ordre alphabétique
dataset_cleaned_filtered$num_dep <- match(dataset_cleaned_filtered$region, unique(dataset_cleaned_filtered$region))

# Chargement du jeu de données
crime_data <- read_xlsx(""dataset_crime.xlsx"") 

# Exclusion des DOM TOM et Corse
crime_data_filtre <- crime_data %>%
  filter(!CodeDépartement %in% c(971, 972, 973, 974, 975, 976, ""NA"", ""2A"", ""2B""))

# Récupération des crimes par département par année
crime_departement_annee <- crime_data_filtre %>%
  group_by(CodeDépartement, annee) %>%
  summarise(total_crimes = sum(faits))
"
"2","`summarise()` has grouped output by 'CodeDépartement'. You can override using the `.groups` argument."
"0","# On ajoute la population par département par année"
"0","crime_departement_annee <- left_join(crime_departement_annee, "
"0","                                     crime_data_filtre %>% "
"0","                                       group_by(CodeDépartement, annee) %>% "
"0","                                       summarise(Population = max(POP)),"
"0","                                     by = c(""CodeDépartement"", ""annee""))"
"2","`summarise()` has grouped output by 'CodeDépartement'. You can override using the `.groups` argument."
"0","# Calcul du taux de criminalité par 1000 habitants pour chaque département"
"0","crime_departement_annee <- mutate(crime_departement_annee, taux_crime_par_1000 = round((total_crimes / as.numeric(Population)) * 1000, 2))"
"0",""
"0","# Amélioration de l'affichage de l'année en ajoutant le préfixe 20 pour obtenir par exemple 2016"
"0","crime_departement_annee$annee <- as.numeric(paste0(""20"", crime_departement_annee$annee))"
"0","crime_departement_annee$CodeDépartement = as.integer(crime_departement_annee$CodeDépartement)"
"0","# Merge to keep only the region column from dataset_cleaned_filtered in crime_departement_annee"
"0","crime_departement_annee <- merge(x = crime_departement_annee, "
"0","                                 y = dataset_cleaned_filtered[, c(""num_dep"", ""region"")], "
"0","                                 by.x = ""CodeDépartement"", "
"0","                                 by.y = ""num_dep"", "
"0","                                 all.x = TRUE)"
"0",""
"0","# Rename the region column to match the column name in crime_departement_annee"
"0","names(crime_departement_annee)[names(crime_departement_annee) == ""Département""] <- ""region"""
"0",""
"0","# Display the first few rows of the result"
"0","head(crime_departement_annee)"
